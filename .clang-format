---
# =============================================================================
# C/C++ Code Standards - Formatting Configuration
# =============================================================================
# Reference: https://clang.llvm.org/docs/ClangFormatStyleOptions.html
#
# To use: Place this file in your project root
# Run: clang-format -i src/**/*.c src/**/*.h
#
# This configuration enforces:
# - Allman brace style (braces on new lines)
# - 4-space indentation (no tabs)
# - 100-character line limit
# - Right-aligned pointers (char *str)
# - Sorted includes
# =============================================================================

Language: Cpp
BasedOnStyle: LLVM

# =============================================================================
# INDENTATION (Rule 40)
# =============================================================================
IndentWidth: 4
TabWidth: 4
UseTab: Never
IndentCaseLabels: true
IndentCaseBlocks: false
IndentGotoLabels: false
IndentPPDirectives: BeforeHash
IndentWrappedFunctionNames: false
NamespaceIndentation: None
ContinuationIndentWidth: 4

# =============================================================================
# BRACES - Allman Style (Rule 40)
# =============================================================================
# Allman style: Opening brace on its own line
BreakBeforeBraces: Custom
BraceWrapping:
  AfterCaseLabel: true
  AfterClass: true
  AfterControlStatement: Always
  AfterEnum: true
  AfterFunction: true
  AfterNamespace: true
  AfterStruct: true
  AfterUnion: true
  AfterExternBlock: true
  BeforeCatch: true
  BeforeElse: true
  BeforeLambdaBody: true
  BeforeWhile: true
  IndentBraces: false
  SplitEmptyFunction: true
  SplitEmptyRecord: true
  SplitEmptyNamespace: true

# =============================================================================
# LINE LENGTH AND WRAPPING
# =============================================================================
ColumnLimit: 100
AlignAfterOpenBracket: Align
AlignOperands: Align
AllowAllArgumentsOnNextLine: false
AllowAllParametersOfDeclarationOnNextLine: false
BinPackArguments: false
BinPackParameters: false

# =============================================================================
# SPACING
# =============================================================================
SpaceAfterCStyleCast: true
SpaceAfterLogicalNot: false
SpaceBeforeAssignmentOperators: true
SpaceBeforeCaseColon: false
SpaceBeforeParens: ControlStatements
SpaceBeforeSquareBrackets: false
SpaceInEmptyBlock: false
SpaceInEmptyParentheses: false
SpacesBeforeTrailingComments: 2
SpacesInAngles: Never
SpacesInCStyleCastParentheses: false
SpacesInConditionalStatement: false
SpacesInContainerLiterals: false
SpacesInParentheses: false
SpacesInSquareBrackets: false

# =============================================================================
# ALIGNMENT
# =============================================================================
AlignConsecutiveAssignments: Consecutive
AlignConsecutiveBitFields: Consecutive
AlignConsecutiveDeclarations: Consecutive
AlignConsecutiveMacros: Consecutive
AlignEscapedNewlines: Left
AlignTrailingComments: true

# =============================================================================
# POINTERS AND REFERENCES (Rule 41)
# =============================================================================
# Right-aligned: char *str (not char* str)
PointerAlignment: Right
DerivePointerAlignment: false
ReferenceAlignment: Right

# =============================================================================
# INCLUDES
# =============================================================================
SortIncludes: CaseSensitive
IncludeBlocks: Regroup
IncludeCategories:
  # Standard C headers
  - Regex: '^<(assert|complex|ctype|errno|fenv|float|inttypes|iso646|limits|locale|math|setjmp|signal|stdalign|stdarg|stdatomic|stdbool|stddef|stdint|stdio|stdlib|stdnoreturn|string|tgmath|threads|time|uchar|wchar|wctype)\.h>'
    Priority: 1
    SortPriority: 1
  # POSIX headers
  - Regex: '^<(unistd|fcntl|sys/|pthread|semaphore|mqueue).*>'
    Priority: 2
    SortPriority: 2
  # C++ standard library
  - Regex: '^<[a-z_]+>'
    Priority: 3
    SortPriority: 3
  # Other system headers
  - Regex: '^<.*>'
    Priority: 4
    SortPriority: 4
  # Project headers
  - Regex: '^".*"'
    Priority: 5
    SortPriority: 5

# =============================================================================
# FUNCTIONS AND BLOCKS
# =============================================================================
AllowShortBlocksOnASingleLine: Never
AllowShortCaseLabelsOnASingleLine: false
AllowShortEnumsOnASingleLine: false
AllowShortFunctionsOnASingleLine: None
AllowShortIfStatementsOnASingleLine: Never
AllowShortLambdasOnASingleLine: None
AllowShortLoopsOnASingleLine: false
AlwaysBreakAfterReturnType: None
AlwaysBreakBeforeMultilineStrings: false

# =============================================================================
# OPERATORS
# =============================================================================
BreakBeforeBinaryOperators: None
BreakBeforeTernaryOperators: true

# =============================================================================
# STRINGS AND COMMENTS
# =============================================================================
BreakStringLiterals: true
ReflowComments: true

# =============================================================================
# MISCELLANEOUS
# =============================================================================
MaxEmptyLinesToKeep: 1
SortUsingDeclarations: true
KeepEmptyLinesAtTheStartOfBlocks: false

# =============================================================================
# C++ SPECIFIC (ignored for C)
# =============================================================================
AccessModifierOffset: -4
AllowAllConstructorInitializersOnNextLine: false
BreakConstructorInitializers: BeforeComma
BreakInheritanceList: BeforeComma
ConstructorInitializerAllOnOneLineOrOnePerLine: true
Cpp11BracedListStyle: true
FixNamespaceComments: true
...
